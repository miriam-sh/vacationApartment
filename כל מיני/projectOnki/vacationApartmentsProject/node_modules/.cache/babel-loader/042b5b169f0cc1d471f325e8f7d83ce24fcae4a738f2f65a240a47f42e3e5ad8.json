{"ast":null,"code":"var _jsxFileName = \"D:\\\\react\\\\home-works-and-lessons\\\\src\\\\RentalCar\\\\Components\\\\Return.jsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useRef, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { RentalDetails } from \"./RentalDetails\";\nimport { addReturn, setCars, setDriveType, setRentals, updateCar, updateReturn } from \"../redux/Actions\";\nimport TextField from '@mui/material/TextField';\nimport SearchIcon from '@mui/icons-material/Search';\nimport Swal from \"sweetalert2\";\nimport { Button, Dialog, DialogContent, DialogContentText, DialogTitle, IconButton } from \"@mui/material\";\nimport CloseIcon from '@mui/icons-material/Close';\nimport { InputWithValidate } from \"./inputs/InputWithValidate\";\nimport { InputIdentity } from \"./inputs/InputIdentity\";\nimport { getRentalsById } from \"../Functions/ApiRequests/Rentals\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const Return = () => {\n  _s();\n  const currentUser = useSelector(x => x.CurrentUser);\n  const rentals = useSelector(x => x.Rentals);\n  const cars = useSelector(x => x.Cars);\n  const driveTypes = useSelector(x => x.DriveTypes);\n  // const userRentals = rentals.filter(r => r.userId == currentUser.id && r.returned == false)\n  let userRentals = useState([]);\n  getRentalsById(currentUser.id).then(x => {\n    console.log(x.data);\n    userRentals = x.data;\n  }).catch(error => {\n    Swal.fire({\n      icon: \"error\",\n      text: \"חלה שגיאה בעדכון הנתונים, אנא דווחו למנהל המערכת\",\n      showConfirmButton: false,\n      timer: 2000\n    });\n  });\n  console.log(userRentals);\n  const [currentRental, setCurrentRental] = useState(null);\n  const [city, setCity] = useState(null);\n  const [street, setStreet] = useState(null);\n  const [balance, setBalance] = useState(null);\n  const [payment, setPayment] = useState(false);\n  const [payByAnotherCard, setPayByAnotherCard] = useState(false);\n  const [errors, setErrors] = useState({});\n  const [identityErrorMessege, setIdentityErrorMessege] = useState();\n  useEffect(() => {\n    if (rentals.length == 0) dis(setRentals);\n    if (driveTypes.length == 0) dis(setDriveType);\n    if (cars.length == 0) dis(setCars());\n    dis(setDriveType());\n  }, []);\n  const rentalIdRef = useRef();\n  const [payForHours, setPayForHours] = useState(0);\n  const [payForFuel, setPayForFuel] = useState(0);\n  const dis = useDispatch();\n  const creditNumberCondition = [{\n    func: value => !/^\\d{16}$/.test(value),\n    messege: \"invalid credit number\"\n  }];\n  const validitiCondition = [{\n    func: value => !/^((0[1-9])|(1[0-2]))-\\d{2}$/.test(value),\n    messege: \"invalid validiti\"\n  }];\n  const cvvCondition = [{\n    func: value => !/^\\d{3}$/.test(value),\n    messege: \"invalid cvv\"\n  }];\n  const find = () => {\n    if (rentalIdRef.current.value.length == 0) return;\n    let rental = rentals.find(r => r.id == rentalIdRef.current.value);\n    if (!rental) {\n      setErrors({\n        ...errors,\n        rentId: 'לא נמצאה השכרה לפי הקוד שהוזן.'\n      });\n      return;\n    }\n    if (rental.userId != currentUser.id) {\n      setErrors({\n        ...errors,\n        rentId: 'אין לך השכרה במערכת עם קוד זה.'\n      });\n      return;\n    }\n    if (rental.returned) {\n      setErrors({\n        ...errors,\n        rentId: 'השכרה זו כבר הוחזרה.'\n      });\n      return;\n    }\n    setCurrentRental(rental);\n  };\n  const updateErrors = key => {\n    setErrors(`{...errors, ${key}:'' }`);\n  };\n  const diffInHours = (d1, d2) => {\n    var t2 = d2.getTime();\n    var t1 = d1.getTime();\n    return Math.floor((t2 - t1) / (3600 * 1000));\n  };\n  const returnCar = () => {\n    if (!city) {\n      setErrors({\n        ...errors,\n        city: 'זהו שדה חובה'\n      });\n      return;\n    }\n    if (!street) {\n      setErrors({\n        ...errors,\n        street: 'זהו שדה חובה'\n      });\n      return;\n    }\n    if (!balance) {\n      setErrors({\n        ...errors,\n        balance: 'זהו שדה חובה'\n      });\n      return;\n    }\n    let car = cars.find(c => c.id == currentRental.carId);\n    let rentalDate = new Date(currentRental.dateAndTime);\n    let now = new Date();\n    let countHours = parseFloat(diffInHours(rentalDate, now));\n    setPayForHours(countHours * car.pricePerHour);\n    let diffBalance = car.balance - balance;\n    let pricePerLiter = parseInt(driveTypes.find(d => d.id == car.driveTypeId).pricePerLiter);\n    setPayForFuel(diffBalance * pricePerLiter);\n    setPayment(true);\n  };\n  const payAndReturn = () => {\n    Swal.fire({\n      title: \"התשלום בוצע בהצלחה\",\n      html: `\n                    <p>קוד האישור מחברת האשראי: ${parseInt(Math.random() * 1000000)}</p>\n \n                `,\n      icon: \"success\",\n      timer: 10000,\n      position: \"center\",\n      timerProgressBar: true\n    });\n    let car = cars.find(c => c.id == currentRental.carId);\n\n    // עדכון פרטי רכב\n    let updatedCar = {\n      ...car\n    };\n    updatedCar.city = city;\n    updatedCar.street = street;\n    updatedCar.balance = balance;\n    updatedCar.available = true;\n    dis(updateCar(car.id, updatedCar));\n\n    // עדכון החזרה\n    // לעשות פונקציה במחלקת השכרות \n    dis(updateReturn(currentRental.id));\n\n    // הוספת החזרה\n    let newReturn = {\n      rentalId: currentRental.id,\n      dateAndTime: new Date(),\n      balance,\n      totalPayable: payForHours + payForFuel,\n      paid: true\n    };\n    rentalIdRef.current.value = '';\n    setCurrentRental(null);\n    setCity(null);\n    setStreet(null);\n    setBalance(null);\n    setPayment(false);\n    dis(addReturn(newReturn));\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"return flex-column\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-column search\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-row\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"inputSearch\",\n          type: \"text\",\n          placeholder: \"\\u05D4\\u05E7\\u05DC\\u05D3 \\u05E7\\u05D5\\u05D3 \\u05D4\\u05E9\\u05D0\\u05DC\\u05D4 \\u05D0\\u05D5 \\u05D1\\u05D7\\u05E8 \\u05D4\\u05E9\\u05D0\\u05DC\\u05D4\",\n          ref: rentalIdRef,\n          onChange: () => setErrors({})\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btnSearch\",\n          onClick: find,\n          children: /*#__PURE__*/_jsxDEV(SearchIcon, {\n            sx: {\n              color: \"white\"\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 63\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 121\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: errors.rentId\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 13\n      }, this), userRentals.length == 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u05D0\\u05D9\\u05DF \\u05DC\\u05DA \\u05D4\\u05E9\\u05DB\\u05E8\\u05D5\\u05EA \\u05E9\\u05DC\\u05D0 \\u05D4\\u05D7\\u05D6\\u05E8\\u05EA\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 41\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 9\n    }, this), currentRental && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"current flex-row\",\n      children: [/*#__PURE__*/_jsxDEV(RentalDetails, {\n        rental: currentRental\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"returnDetails\",\n        children: [/*#__PURE__*/_jsxDEV(TextField, {\n          onChange: event => {\n            setCity(event.target.value);\n            updateErrors(city);\n          },\n          className: \"standard-basic\",\n          label: \"\\u05E2\\u05D9\\u05E8\",\n          variant: \"standard\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 81\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: errors.city\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(TextField, {\n          onChange: event => {\n            setStreet(event.target.value);\n            updateErrors(street);\n          },\n          className: \"standard-basic\",\n          label: \"\\u05E8\\u05D7\\u05D5\\u05D1\",\n          variant: \"standard\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 82\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: errors.street\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(TextField, {\n          onChange: event => {\n            setBalance(event.target.value);\n            updateErrors(balance);\n          },\n          className: \"standard-basic\",\n          type: \"number\",\n          label: \"\\u05D9\\u05EA\\u05E8\\u05EA \\u05D4\\u05D3\\u05DC\\u05E7\",\n          variant: \"standard\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 17\n        }, this), \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 102\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: errors.balance\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn\",\n          onClick: returnCar,\n          children: \"\\u05DC\\u05D4\\u05D7\\u05D6\\u05E8\\u05D4 \\u05D5\\u05EA\\u05E9\\u05DC\\u05D5\\u05DD\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 27\n    }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n      open: payment,\n      id: \"DialogPayment\",\n      children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n        id: \"closeDialog\",\n        children: [/*#__PURE__*/_jsxDEV(IconButton, {\n          className: \"roundButton\",\n          onClick: () => setPayment(false),\n          children: /*#__PURE__*/_jsxDEV(CloseIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 88\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(DialogContentText, {\n          className: \"title\",\n          children: \"\\u05EA\\u05E9\\u05DC\\u05D5\\u05DD\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n        className: \"content\",\n        children: [/*#__PURE__*/_jsxDEV(DialogContentText, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(DialogContentText, {\n          children: [\"\\u05D4\\u05EA\\u05E9\\u05DC\\u05D5\\u05DD \\u05E2\\u05D1\\u05D5\\u05E8 \\u05DE\\u05E9\\u05DA \\u05D4\\u05E9\\u05DB\\u05E8\\u05D4: \", payForHours]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(DialogContentText, {\n          children: [\"\\u05D4\\u05EA\\u05E9\\u05DC\\u05D5\\u05DD \\u05E2\\u05D1\\u05D5\\u05E8 \\u05D4\\u05D3\\u05DC\\u05E7: \", payForFuel]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(DialogContentText, {\n          children: [\"\\u05E1\\u05D4\\\"\\u05DB \\u05DC\\u05EA\\u05E9\\u05DC\\u05D5\\u05DD: \", payForFuel + payForHours]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          className: \"payBtn\",\n          onClick: () => {\n            setPayment(false);\n            payAndReturn();\n          },\n          children: \"\\u05DC\\u05EA\\u05E9\\u05DC\\u05D5\\u05DD \\u05D1\\u05DB\\u05E8\\u05D8\\u05D9\\u05E1 \\u05D0\\u05E9\\u05E8\\u05D0\\u05D9 \\u05D4\\u05E9\\u05DE\\u05D5\\u05E8 \\u05D1\\u05DE\\u05E2\\u05E8\\u05DB\\u05EA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          className: \"payBtn\",\n          onClick: () => {\n            setPayment(false);\n            setPayByAnotherCard(true);\n          },\n          children: \"\\u05DC\\u05EA\\u05E9\\u05DC\\u05D5\\u05DD \\u05D1\\u05DB\\u05E8\\u05D8\\u05D9\\u05E1 \\u05D0\\u05E9\\u05E8\\u05D0\\u05D9 \\u05D0\\u05D7\\u05E8\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n      open: payByAnotherCard,\n      id: \"DialogPayment\",\n      children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n        id: \"closeDialog\",\n        children: [/*#__PURE__*/_jsxDEV(IconButton, {\n          className: \"roundButton\",\n          onClick: () => setPayByAnotherCard(false),\n          children: /*#__PURE__*/_jsxDEV(CloseIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 245,\n            columnNumber: 97\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(DialogContentText, {\n          className: \"title\",\n          children: \"\\u05EA\\u05E9\\u05DC\\u05D5\\u05DD\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n        className: \"content2\",\n        children: [/*#__PURE__*/_jsxDEV(DialogContentText, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(DialogContentText, {\n          children: [\"\\u05D4\\u05EA\\u05E9\\u05DC\\u05D5\\u05DD \\u05E2\\u05D1\\u05D5\\u05E8 \\u05DE\\u05E9\\u05DA \\u05D4\\u05E9\\u05DB\\u05E8\\u05D4: \", payForHours]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(DialogContentText, {\n          children: [\"\\u05D4\\u05EA\\u05E9\\u05DC\\u05D5\\u05DD \\u05E2\\u05D1\\u05D5\\u05E8 \\u05D4\\u05D3\\u05DC\\u05E7: \", payForFuel]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(DialogContentText, {\n          children: [\"\\u05E1\\u05D4\\\"\\u05DB \\u05DC\\u05EA\\u05E9\\u05DC\\u05D5\\u05DD: \", payForFuel + payForHours]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-column\",\n          children: [/*#__PURE__*/_jsxDEV(InputWithValidate, {\n            className: \"inputTextField\",\n            id: \"creditNumberInput\",\n            label: \"credit number\",\n            conditions: creditNumberCondition,\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(InputWithValidate, {\n            className: \"inputTextField\",\n            id: \"validityInput\",\n            label: \"validity\",\n            conditions: validitiCondition,\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 255,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(InputWithValidate, {\n            className: \"inputTextField\",\n            id: \"cvvInput\",\n            type: \"password\",\n            label: \"cvv\",\n            conditions: cvvCondition,\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 256,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(InputIdentity, {\n            className: \"inputTextField\",\n            id: \"tzInput\",\n            label: \"identity\",\n            errorMessege: identityErrorMessege\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          className: \"payBtn\",\n          onClick: () => {\n            setPayByAnotherCard(false);\n            payAndReturn();\n          },\n          children: \"\\u05DC\\u05EA\\u05E9\\u05DC\\u05D5\\u05DD\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-row userRents\",\n      children: userRentals && userRentals.map(r => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"rentalDetails\",\n        onClick: () => {\n          rentalIdRef.current.value = r.id;\n          find();\n        },\n        children: /*#__PURE__*/_jsxDEV(RentalDetails, {\n          rental: r\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 153\n        }, this)\n      }, r.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 50\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 190,\n    columnNumber: 12\n  }, this);\n};\n_s(Return, \"dTyQbPucbYjMUCVl6zcdTvZPU3Y=\", false, function () {\n  return [useSelector, useSelector, useSelector, useSelector, useDispatch];\n});\n_c = Return;\nvar _c;\n$RefreshReg$(_c, \"Return\");","map":{"version":3,"names":["useEffect","useRef","useState","useDispatch","useSelector","RentalDetails","addReturn","setCars","setDriveType","setRentals","updateCar","updateReturn","TextField","SearchIcon","Swal","Button","Dialog","DialogContent","DialogContentText","DialogTitle","IconButton","CloseIcon","InputWithValidate","InputIdentity","getRentalsById","jsxDEV","_jsxDEV","Return","_s","currentUser","x","CurrentUser","rentals","Rentals","cars","Cars","driveTypes","DriveTypes","userRentals","id","then","console","log","data","catch","error","fire","icon","text","showConfirmButton","timer","currentRental","setCurrentRental","city","setCity","street","setStreet","balance","setBalance","payment","setPayment","payByAnotherCard","setPayByAnotherCard","errors","setErrors","identityErrorMessege","setIdentityErrorMessege","length","dis","rentalIdRef","payForHours","setPayForHours","payForFuel","setPayForFuel","creditNumberCondition","func","value","test","messege","validitiCondition","cvvCondition","find","current","rental","r","rentId","userId","returned","updateErrors","key","diffInHours","d1","d2","t2","getTime","t1","Math","floor","returnCar","car","c","carId","rentalDate","Date","dateAndTime","now","countHours","parseFloat","pricePerHour","diffBalance","pricePerLiter","parseInt","d","driveTypeId","payAndReturn","title","html","random","position","timerProgressBar","updatedCar","available","newReturn","rentalId","totalPayable","paid","className","children","type","placeholder","ref","onChange","fileName","_jsxFileName","lineNumber","columnNumber","onClick","sx","color","event","target","label","variant","open","conditions","required","errorMessege","map","_c","$RefreshReg$"],"sources":["D:/react/home-works-and-lessons/src/RentalCar/Components/Return.jsx"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\"\r\nimport { useDispatch, useSelector } from \"react-redux\"\r\nimport { RentalDetails } from \"./RentalDetails\"\r\nimport { addReturn, setCars, setDriveType, setRentals, updateCar, updateReturn } from \"../redux/Actions\"\r\nimport TextField from '@mui/material/TextField';\r\nimport SearchIcon from '@mui/icons-material/Search';\r\nimport Swal from \"sweetalert2\";\r\nimport { Button, Dialog, DialogContent, DialogContentText, DialogTitle, IconButton } from \"@mui/material\";\r\nimport CloseIcon from '@mui/icons-material/Close';\r\nimport { InputWithValidate } from \"./inputs/InputWithValidate\";\r\nimport { InputIdentity } from \"./inputs/InputIdentity\";\r\nimport { getRentalsById } from \"../Functions/ApiRequests/Rentals\";\r\n\r\nexport const Return = () => {\r\n\r\n    const currentUser = useSelector(x => x.CurrentUser)\r\n    const rentals = useSelector(x => x.Rentals)\r\n    const cars = useSelector(x => x.Cars)\r\n    const driveTypes = useSelector(x => x.DriveTypes)\r\n    // const userRentals = rentals.filter(r => r.userId == currentUser.id && r.returned == false)\r\n    let userRentals = useState([])\r\n    getRentalsById(currentUser.id)\r\n        .then(x => {\r\n            console.log(x.data);\r\n            userRentals = x.data\r\n        })\r\n        .catch(error => {\r\n            Swal.fire({\r\n                icon: \"error\",\r\n                text: \"חלה שגיאה בעדכון הנתונים, אנא דווחו למנהל המערכת\",\r\n                showConfirmButton: false,\r\n                timer: 2000\r\n            })\r\n        })\r\n\r\n    console.log(userRentals);\r\n\r\n\r\n    const [currentRental, setCurrentRental] = useState(null)\r\n    const [city, setCity] = useState(null)\r\n    const [street, setStreet] = useState(null)\r\n    const [balance, setBalance] = useState(null)\r\n    const [payment, setPayment] = useState(false)\r\n    const [payByAnotherCard, setPayByAnotherCard] = useState(false)\r\n    const [errors, setErrors] = useState({})\r\n    const [identityErrorMessege, setIdentityErrorMessege] = useState()\r\n\r\n    useEffect(() => {\r\n        if (rentals.length == 0)\r\n            dis(setRentals)\r\n        if (driveTypes.length == 0)\r\n            dis(setDriveType)\r\n        if (cars.length == 0)\r\n            dis(setCars())\r\n        dis(setDriveType())\r\n    }, [])\r\n\r\n    const rentalIdRef = useRef()\r\n\r\n    const [payForHours, setPayForHours] = useState(0)\r\n    const [payForFuel, setPayForFuel] = useState(0)\r\n\r\n    const dis = useDispatch()\r\n\r\n    const creditNumberCondition = [{ func: (value) => !/^\\d{16}$/.test(value), messege: \"invalid credit number\" }]\r\n\r\n    const validitiCondition = [{ func: (value) => !/^((0[1-9])|(1[0-2]))-\\d{2}$/.test(value), messege: \"invalid validiti\" }]\r\n\r\n    const cvvCondition = [{ func: (value) => !/^\\d{3}$/.test(value), messege: \"invalid cvv\" }]\r\n\r\n\r\n    const find = () => {\r\n        if (rentalIdRef.current.value.length == 0)\r\n            return\r\n        let rental = rentals.find(r => r.id == rentalIdRef.current.value)\r\n\r\n        if (!rental) {\r\n            setErrors({ ...errors, rentId: 'לא נמצאה השכרה לפי הקוד שהוזן.' })\r\n            return\r\n        }\r\n\r\n        if (rental.userId != currentUser.id) {\r\n            setErrors({ ...errors, rentId: 'אין לך השכרה במערכת עם קוד זה.' })\r\n            return\r\n        }\r\n\r\n        if (rental.returned) {\r\n            setErrors({ ...errors, rentId: 'השכרה זו כבר הוחזרה.' })\r\n            return\r\n        }\r\n\r\n        setCurrentRental(rental)\r\n    }\r\n\r\n    const updateErrors = (key) => {\r\n        setErrors(`{...errors, ${key}:'' }`)\r\n    }\r\n\r\n    const diffInHours = (d1, d2) => {\r\n        var t2 = d2.getTime();\r\n        var t1 = d1.getTime();\r\n\r\n        return Math.floor((t2 - t1) / (3600 * 1000));\r\n    }\r\n\r\n    const returnCar = () => {\r\n\r\n        if (!city) {\r\n            setErrors({ ...errors, city: 'זהו שדה חובה' })\r\n            return\r\n        }\r\n\r\n        if (!street) {\r\n            setErrors({ ...errors, street: 'זהו שדה חובה' })\r\n            return\r\n        }\r\n\r\n        if (!balance) {\r\n            setErrors({ ...errors, balance: 'זהו שדה חובה' })\r\n            return\r\n        }\r\n\r\n        let car = cars.find(c => c.id == currentRental.carId);\r\n\r\n        let rentalDate = new Date(currentRental.dateAndTime)\r\n\r\n        let now = new Date()\r\n        let countHours = parseFloat(diffInHours(rentalDate, now))\r\n\r\n        setPayForHours(countHours * car.pricePerHour)\r\n\r\n        let diffBalance = car.balance - balance\r\n\r\n        let pricePerLiter = parseInt(driveTypes.find(d => d.id == car.driveTypeId).pricePerLiter)\r\n        setPayForFuel(diffBalance * pricePerLiter)\r\n\r\n        setPayment(true)\r\n\r\n    }\r\n\r\n    const payAndReturn = () => {\r\n\r\n        Swal.fire({\r\n            title: \"התשלום בוצע בהצלחה\",\r\n            html:\r\n                `\r\n                    <p>קוד האישור מחברת האשראי: ${parseInt(Math.random() * 1000000)}</p>\r\n \r\n                `,\r\n            icon: \"success\",\r\n            timer: 10000,\r\n            position: \"center\",\r\n            timerProgressBar: true,\r\n        })\r\n\r\n        let car = cars.find(c => c.id == currentRental.carId);\r\n\r\n        // עדכון פרטי רכב\r\n        let updatedCar = { ...car }\r\n        updatedCar.city = city\r\n        updatedCar.street = street\r\n        updatedCar.balance = balance\r\n        updatedCar.available = true\r\n        dis(updateCar(car.id, updatedCar))\r\n\r\n        // עדכון החזרה\r\n        // לעשות פונקציה במחלקת השכרות \r\n        dis(updateReturn(currentRental.id))\r\n\r\n        // הוספת החזרה\r\n        let newReturn = {\r\n            rentalId: currentRental.id,\r\n            dateAndTime: new Date(),\r\n            balance,\r\n            totalPayable: payForHours + payForFuel,\r\n            paid: true\r\n        }\r\n\r\n        rentalIdRef.current.value = ''\r\n        setCurrentRental(null)\r\n        setCity(null)\r\n        setStreet(null)\r\n        setBalance(null)\r\n        setPayment(false)\r\n\r\n        dis(addReturn(newReturn))\r\n\r\n    }\r\n\r\n    return <div className=\"return flex-column\">\r\n        <div className=\"flex-column search\">\r\n            <div className=\"flex-row\">\r\n                <input className=\"inputSearch\" type='text' placeholder=\"הקלד קוד השאלה או בחר השאלה\" ref={rentalIdRef} onChange={() => setErrors({})} ></input>\r\n                <button className=\"btnSearch\" onClick={find} ><SearchIcon sx={{ color: \"white\" }}></SearchIcon></button><br></br>\r\n            </div>\r\n            <p>{errors.rentId}</p>\r\n            {userRentals.length == 0 && <p>אין לך השכרות שלא החזרת</p>}\r\n\r\n        </div>\r\n        <br></br>\r\n\r\n\r\n        {currentRental && <div className=\"current flex-row\">\r\n            <RentalDetails rental={currentRental}></RentalDetails>\r\n            <div className=\"returnDetails\">\r\n                <TextField onChange={(event) => {\r\n                    setCity(event.target.value)\r\n                    updateErrors(city)\r\n                }}\r\n                    className=\"standard-basic\" label=\"עיר\" variant=\"standard\" /><br></br>\r\n                <p>{errors.city}</p>\r\n                <TextField onChange={(event) => {\r\n                    setStreet(event.target.value)\r\n                    updateErrors(street)\r\n                }}\r\n                    className=\"standard-basic\" label=\"רחוב\" variant=\"standard\" /><br></br>\r\n                <p>{errors.street}</p>\r\n                <TextField onChange={(event) => {\r\n                    setBalance(event.target.value)\r\n                    updateErrors(balance)\r\n                }}\r\n                    className=\"standard-basic\" type=\"number\" label=\"יתרת הדלק\" variant=\"standard\" /> <br></br>\r\n                <p>{errors.balance}</p>\r\n                <button className=\"btn\" onClick={returnCar}>להחזרה ותשלום</button>\r\n            </div>\r\n        </div>}\r\n\r\n        <Dialog open={payment} id=\"DialogPayment\">\r\n            <DialogTitle id=\"closeDialog\">\r\n                <IconButton className=\"roundButton\" onClick={() => setPayment(false)} ><CloseIcon /></IconButton>\r\n                <DialogContentText className=\"title\">תשלום</DialogContentText>\r\n            </DialogTitle>\r\n            <DialogContent className=\"content\" >\r\n                <DialogContentText></DialogContentText>\r\n                <DialogContentText>התשלום עבור משך השכרה: {payForHours}</DialogContentText>\r\n                <DialogContentText>התשלום עבור הדלק: {payForFuel}</DialogContentText>\r\n                <DialogContentText>סה\"כ לתשלום: {payForFuel + payForHours}</DialogContentText>\r\n                <Button className=\"payBtn\" onClick={() => { setPayment(false); payAndReturn() }}>לתשלום בכרטיס אשראי השמור במערכת</Button>\r\n                <Button className=\"payBtn\" onClick={() => { setPayment(false); setPayByAnotherCard(true) }}>לתשלום בכרטיס אשראי אחר</Button>\r\n            </DialogContent>\r\n        </Dialog>\r\n\r\n        <Dialog open={payByAnotherCard} id=\"DialogPayment\">\r\n            <DialogTitle id=\"closeDialog\">\r\n                <IconButton className=\"roundButton\" onClick={() => setPayByAnotherCard(false)} ><CloseIcon /></IconButton>\r\n                <DialogContentText className=\"title\">תשלום</DialogContentText>\r\n            </DialogTitle>\r\n            <DialogContent className=\"content2\" >\r\n                <DialogContentText></DialogContentText>\r\n                <DialogContentText>התשלום עבור משך השכרה: {payForHours}</DialogContentText>\r\n                <DialogContentText>התשלום עבור הדלק: {payForFuel}</DialogContentText>\r\n                <DialogContentText>סה\"כ לתשלום: {payForFuel + payForHours}</DialogContentText>\r\n                <div className=\"flex-column\">\r\n                    <InputWithValidate className=\"inputTextField\" id=\"creditNumberInput\" label=\"credit number\" conditions={creditNumberCondition} required={true}></InputWithValidate>\r\n                    <InputWithValidate className=\"inputTextField\" id=\"validityInput\" label=\"validity\" conditions={validitiCondition} required={true}></InputWithValidate>\r\n                    <InputWithValidate className=\"inputTextField\" id=\"cvvInput\" type=\"password\" label=\"cvv\" conditions={cvvCondition} required={true}></InputWithValidate>\r\n                    <InputIdentity className=\"inputTextField\" id=\"tzInput\" label=\"identity\" errorMessege={identityErrorMessege}></InputIdentity>\r\n                </div>\r\n                <Button className=\"payBtn\" onClick={() => { setPayByAnotherCard(false); payAndReturn() }}>לתשלום</Button>\r\n            </DialogContent>\r\n        </Dialog>\r\n\r\n        <div className=\"flex-row userRents\">\r\n            {userRentals && userRentals.map(r => <div className=\"rentalDetails\" key={r.id} onClick={() => { rentalIdRef.current.value = r.id; find() }}><RentalDetails rental={r} ></RentalDetails></div>)}\r\n        </div>\r\n\r\n    </div>\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}